/*
 ANNOTATIONS for Lease Calculator (pre-refactor)
 Annotated on 2025-10-17 17:31 — ner-calculator/css/styles.css
 These notes are additive and do not change behavior.

*/


/* Overview:
   - Dark theme tokens via CSS variables.
   - Responsive 4-col grid for inputs; KPI card grid.
   - Form adornments for % and $/SF/yr inputs.
   - Table styles incl. year subtotal rows (.year-row) with annualized PSFs.
   - Map frame, scenario compare grid, chart headings, PDF modal, photo uploader.
   These comments document intent only; no selector behavior changed.
*/


:root {
    --bg: #0b0b0c;
    --panel: rgba(255, 255, 255, 0.06);
    --panel-2: rgba(255, 255, 255, 0.10);
    --card: rgba(255, 255, 255, 0.10);
    --stroke: rgba(255, 255, 255, 0.14);
    --text: #f5f5f7;
    --muted: #b7b7bf;
    --accent: #0a84ff;
    --accent-2: #64d2ff;
    --lee-red: #E84D4D;
    --popup-bg-a: rgba(8, 8, 10, 0.92);
    --popup-bg-b: rgba(8, 8, 10, 0.86);
    --popup-border: rgba(255, 255, 255, 0.08);
    --popup-shadow: 0 12px 34px rgba(0, 0, 0, .45);
    --radius: 20px;
    --shadow: 0 8px 30px rgba(0, 0, 0, .35), inset 0 1px 0 rgba(255, 255, 255, .04);
    --container-max: 1600px;
    color-scheme: dark;
}

/* hide only the OpEx service-include rows by default */
.opx .service-include {
    display: none !important;
}

* {
    box-sizing: border-box;
}

html,
body {
    height: 100%;
}

body {
    margin: 0;
    font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial;
    background: radial-gradient(1200px 600px at 20% -10%, rgba(10, 132, 255, .25), transparent 60%),
        radial-gradient(900px 500px at 100% 10%, rgba(100, 210, 255, .18), transparent 60%),
        var(--bg);
    color: var(--text);
    line-height: 1.4;
}

.skip {
    position: absolute;
    left: -9999px;
}

.skip:focus {
    left: 12px;
    top: 12px;
    background: #fff;
    color: #000;
    padding: 8px 10px;
    border-radius: 8px;
}

.site-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px clamp(16px, 3vw, 40px);
    backdrop-filter: saturate(180%) blur(16px);
    background: linear-gradient(180deg, rgba(255, 255, 255, .12), rgba(255, 255, 255, .04));
    border-bottom: 1px solid var(--stroke);
}

.brand {
    display: flex;
    align-items: center;
    gap: 12px;
}

.logo {
    width: 50px;
    height: 25px;
}

.brand-text {
    display: flex;
    flex-direction: column;
}

.brand-top {
    font-weight: 700;
    letter-spacing: .2px;
}

.brand-bottom {
    color: var(--muted);
    font-size: .9rem;
}

.nav {
    display: flex;
    gap: 14px;
}

.nav-link {
    text-decoration: none;
    color: var(--muted);
    padding: 8px 12px;
    border-radius: 999px;
    border: 1px solid transparent;
    transition: .2s ease;
}

.nav-link.active,
.nav-link:hover {
    color: var(--text);
    border-color: var(--stroke);
    background: var(--panel-2);
}

.nav-link.disabled {
    opacity: .45;
    pointer-events: none;
}

.container.one-col {
    max-width: var(--container-max);
    margin: 24px auto 60px;
    padding: 0 clamp(16px, 3vw, 40px);
    display: grid;
    gap: 24px;
    grid-template-columns: 1fr;
}

.container.one-col.widescreen {
    --container-max: 1680px;
}

/* Force a grid item into the right column of the 2-col form */
.col-right {
    grid-column: 2 / 3;
}

@media (max-width: 700px) {
    .col-right {
        grid-column: 1 / -1;
    }

    /* stack nicely on mobile */
}

/* 4-column grid utilities for the inputs section */
/* --- 4-col grid helpers --- */
.grid-4 {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    /* each column, equal width */
    gap: 16px;
    grid-auto-flow: dense;
}

/* Logo in Inputs panel, top-right */
.panel-inputs {
    position: relative;
}

.panel-inputs .panel-logo {
    position: absolute;
    top: clamp(12px, 1.6vw, 18px);
    right: clamp(12px, 1.6vw, 18px);
    height: clamp(40px, 3.6vw, 80px);
    width: auto;
    opacity: .95;
    pointer-events: none;
    /* purely decorative */
    filter: drop-shadow(0 1px 0 rgba(0, 0, 0, .3));
}

/* Optional: hide on very small screens to avoid crowding */
@media (max-width: 560px) {
    .panel-inputs .panel-logo {
        display: none;
    }
}

/* Keep the inputs grid in row order so checkboxes sit under cols 1–2 */
.panel-inputs .grid-4 {
    grid-auto-flow: row;
    /* was: dense */
}

/* Let Discount Rate span two rows so the checkbox can sit directly beneath col-1 */
.panel-inputs .grid-4 #discountField {
    grid-row: span 2;
    align-self: start;
    /* don't stretch */
}

/* Keep the commission checkbox under column 1 */
.panel-inputs .grid-4>.service-include {
    grid-column-start: 1 !important;
    grid-column-end: 2 !important;
}

/* On narrow screens, revert the span so stacking stays natural */
@media (max-width: 900px) {
    .panel-inputs .grid-4 #discountField {
        grid-row: auto;
    }
}

.col-1 {
    grid-column: 1 / 2;
}

.col-2 {
    grid-column: 2 / 3;
}

.col-3 {
    grid-column: 3 / 4;
}

.col-4 {
    grid-column: 4 / 5;
}

.col-1-2 {
    grid-column: 1 / span 2;
}

/* spans columns 1 + 2 */
.col-3-4 {
    grid-column: 3 / span 2;
}

/* spans columns 3 + 4 */
.col-span-4 {
    grid-column: 1 / -1;
}

/* Force controls to actually fill their grid cell */
.field input,
.field select,
.field .input-with-addon {
    width: 100%;
}

/* Make addon layout solid and consistent widths */
.input-with-addon {
    display: grid;
    grid-template-columns: auto 1fr auto;
    /* [addon] [input] [addon] */
    align-items: stretch;
}

.input-with-addon .addon {
    display: flex;
    align-items: center;
    white-space: nowrap;
}

@media (max-width: 900px) {
    .grid-4 {
        grid-template-columns: 1fr 1fr;
    }

    .col-1-2,
    .col-3-4,
    .col-span-4 {
        grid-column: 1 / -1;
    }

    /* stack neatly */
}

@media (max-width: 600px) {
    .grid-4 {
        grid-template-columns: 1fr;
    }
}

/* Make "Include in Services" rows behave like full-width rows */
.field.service-include {
    /* apply to the checkbox row container */
    grid-column: 1 / span 2;
    /* spans cols 1 & 2 (safety if class used without col-1-2) */
}

.results-controls .inline-check,
.kpi-controls .inline-check {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    margin-top: 6px;
    color: var(--muted);
}


.panel {
    background: var(--panel);
    border: 1px solid var(--stroke);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: clamp(18px, 2.2vw, 28px);
}

.panel-title {
    margin: 0 0 6px;
    font-size: clamp(24px, 2.6vw, 32px);
    letter-spacing: .2px;
}

.panel-subtitle {
    margin: 0 0 16px;
    color: var(--muted);
}

.grid {
    display: grid;
    gap: 16px;
    grid-template-columns: repeat(2, 1fr);
}

@media (max-width: 700px) {
    .grid {
        grid-template-columns: 1fr;
    }
}

.field {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

label {
    font-weight: 600;
    letter-spacing: .2px;
}

input,
select {
    background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .04));
    border: 1px solid var(--stroke);
    border-radius: 14px;
    padding: 12px 14px;
    color: var(--text);
    outline: none;
    transition: .2s ease;
}

select.select-filled {
    background: rgba(255, 255, 255, .14);
    border-color: rgba(255, 255, 255, .22);
}

input:focus,
select:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 4px rgba(10, 132, 255, .15);
}

/* Free Rent input (months) + placement + timing in one row */
.free-rent-row {
    display: grid;
    grid-template-columns: minmax(0, 1fr) minmax(140px, auto) minmax(150px, auto);
    gap: 8px;
}

/* Let selects shrink so they can sit side-by-side */
.free-rent-row select.select-filled {
    min-width: 0;
}

/* Optional: stack nicely on narrow screens */
@media (max-width: 700px) {
    .free-rent-row {
        grid-template-columns: 1fr 1fr;
    }

    .free-rent-row select.select-filled:last-child {
        grid-column: 1 / -1;
    }
}


/* Dark dropdown rows for Chrome/Edge */
select option,
select optgroup {
    background-color: #1a1a1a;
    color: #f5f5f7;
}

select option:hover,
select option:focus,
select option:checked {
    background-color: #2b2b2b !important;
    color: #fff !important;
}

select:focus option {
    background-color: #1a1a1a;
}

.input-with-addon {
    display: flex;
    align-items: stretch;
    gap: 0;
}

.input-with-addon .addon {
    background: rgba(255, 255, 255, .14);
    border: 1px solid var(--stroke);
    border-left: none;
    border-radius: 0 12px 12px 0;
    padding: 12px 12px;
    display: flex;
    align-items: center;
    color: var(--muted);
    white-space: nowrap;
}

.input-with-addon input {
    border-radius: 12px 0 0 12px;
    border-right: none;
}

.two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px 12px;
}

.two-col label.right {
    text-align: right;
    color: var(--muted);
    font-weight: 600;
}

.two-col .inline-check {
    grid-column: 1 / -1;
}

.hint {
    color: var(--muted);
    font-size: .85rem;
}

.actions {
    grid-column: 1 / -1;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-top: 4px;
}

.btn {
    border-radius: 999px;
    padding: 12px 18px;
    border: 1px solid var(--stroke);
    background: var(--panel-2);
    color: var(--text);
    font-weight: 650;
    letter-spacing: .2px;
    cursor: pointer;
    transition: .2s ease;
}

.btn:hover {
    transform: translateY(-1px);
}

.btn.primary {
    background: linear-gradient(180deg, var(--lee-red), #ff5a6a);
    border-color: transparent;
    color: #fff;
}

.btn.ghost {
    background: transparent;
}

.btn.subtle {
    background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .02));
}

/* pill-style segmented buttons */
.view-toggle {
    display: flex;
    gap: 8px;
    align-items: center;
    margin-left: 8px;
    flex-wrap: wrap;
}

.seg-btn {
    background: var(--surface-2, #1a1f28);
    color: var(--text-2, #a0acba);
    border: 1px solid var(--card-border, rgba(255, 255, 255, .08));
    border-radius: 999px;
    padding: 6px 12px;
    font-weight: 600;
    line-height: 1;
    transition: .18s ease;
}

.seg-btn:hover {
    filter: brightness(1.1);
}

.seg-btn.active {
    color: var(--text-1, #e8eef7);
    background: var(--accent-blue, #3b82f6);
    border-color: transparent;
    box-shadow: 0 6px 18px rgba(59, 130, 246, .25);
}

/* utility to hide sections cleanly */
.hidden {
    display: none !important;
}

/* Segmented toggle buttons styled to match site */
.toggle-group {
    display: flex;
    gap: 8px;
    margin: 8px 0 12px;
    flex-wrap: wrap;
}

.toggle {
    background: var(--panel-2);
    border: 1px solid var(--stroke);
    color: var(--text);
    padding: 8px 12px;
    border-radius: 999px;
    cursor: pointer;
    font-weight: 650;
    letter-spacing: .2px;
}

.toggle:hover {
    transform: translateY(-1px);
}

.toggle.active {
    background: var(--lee-red);
    border-color: transparent;
    color: #fff;
}

.table-wrap {
    overflow: auto;
    border-radius: 14px;
    border: 1px solid var(--stroke);
}
.monthly-sub-view .subtotal-row {
    background: color-mix(in srgb, var(--accent) 10%, transparent);
    border-top: 2px solid var(--accent); }
    
.schedule {
    width: 100%;
    border-collapse: collapse;
    background: rgba(255, 255, 255, .02);
}

.schedule th,
.schedule td {
    padding: 10px 12px;
    border-bottom: 1px solid rgba(255, 255, 255, .08);
    text-align: right;
}

.schedule th:first-child {
    text-align: center;
}

.schedule th {
    background: rgba(255, 255, 255, .04);
    position: sticky;
    top: 0;
    backdrop-filter: blur(8px);
}

.schedule tbody tr:hover {
    background: rgba(255, 255, 255, .03);
}

.schedule tbody tr.row-subtotal:hover,
.schedule tbody tr.row-grandtotal:hover {
    background: inherit;
}

.row-subtotal {
    border-top: 2px solid var(--accent, #E84D4D);
    background: color-mix(in srgb, var(--accent, #E84D4D) 10%, transparent);
}

.row-subtotal td:first-child {
    text-align: left;
}

.row-subtotal .cell-dollar {
    font-weight: 600;
}

.year-chip {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 34px;
    height: 22px;
    padding: 0 10px;
    margin-right: 8px;
    border-radius: 9999px;
    background: color-mix(in srgb, var(--accent, #E84D4D) 22%, transparent);
    color: #ffffff;
    font-weight: 700;
    letter-spacing: 0.2px;
    font-size: 12px;
}

.cell-muted {
    color: color-mix(in srgb, currentColor 60%, transparent);
    text-align: center;
    font-variant-numeric: tabular-nums;
}

.row-grandtotal {
    border-top: 2px solid var(--accent, #E84D4D);
    border-bottom: 2px solid var(--accent, #E84D4D);
    background: color-mix(in srgb, var(--accent, #E84D4D) 16%, transparent);
    font-size: 1.05em;
}

.row-grandtotal td:first-child {
    text-align: left;
}

.row-grandtotal .cell-dollar {
    font-weight: 700;
}

.row-grandtotal td {
    padding-top: 10px;
    padding-bottom: 10px;
}

/* Span the full two-column grid */
.span-all {
    grid-column: 1 / -1;
}

/* Span helper (already in your sheet, shown for clarity) */
.span-all {
    grid-column: 1 / -1;
}


/* Golden-ratio-ish, landscape map */
.map {
    width: 100%;
    aspect-ratio: 1.6 / 1;
    /* ~golden ratio (1.618) */
    min-height: 420px;
    /* floor on small/medium screens */
    max-height: 60vh;
    /* don’t get too tall on huge screens */
    border-radius: 14px;
    border: 1px solid var(--stroke);
    background: var(--panel);
    box-shadow: var(--shadow);
    overflow: hidden;
}

@media (max-width: 700px) {
    .map {
        min-height: 320px;
    }
}

/* Removed duplicate .map rule and Leaflet-specific styles (using MapTiler SDK) */

.site-footer {
    max-width: var(--container-max);
    margin: 0 auto 40px;
    padding: 0 clamp(16px, 3vw, 40px);
    display: flex;
    gap: 10px;
    align-items: center;
    color: var(--muted);
}

.sep {
    opacity: .5;
}

.footer-link {
    color: var(--muted);
    text-decoration: none;
    border-bottom: 1px dashed rgba(255, 255, 255, .2);
}

.footer-link:hover {
    color: var(--text);
}

.inline-check {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    margin-top: 6px;
    color: var(--muted);
}

.year-row {
    background: rgba(255, 255, 255, .05);
    cursor: pointer;
    font-weight: 700;
}

.year-row td {
    text-align: left;
}

.hidden {
    display: none;
}

/* Chips on year headers */
.year-row td {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
}

.yr-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.chip {
    background: rgba(255, 255, 255, .08);
    border: 1px solid var(--stroke);
    color: var(--text);
    border-radius: 999px;
    padding: 4px 8px;
    font-size: .85rem;
    font-weight: 600;
    white-space: nowrap;
}

/* KPI cards grid (restored) */
.panel-results .cards {
    display: grid;
    gap: 12px;
    grid-template-columns: repeat(4, 1fr);
    margin-bottom: 10px;
}

@media (max-width: 1100px) {
    .panel-results .cards {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 560px) {
    .panel-results .cards {
        grid-template-columns: 1fr;
    }
}

/* NEW: glow + lift on hover/focus (matches input focus ring) */
.panel-results .cards .card:hover,
.panel-results .cards .card:focus-visible,
.panel-results .cards .card:focus-within {
    border-color: var(--accent);
    /* same as inputs */
    box-shadow: var(--shadow), 0 0 0 4px rgba(10, 132, 255, .15);
    /* same glow */
    transform: translateY(-2px);
    /* lift */
    outline: none;
}

/* When Charts view is active, hide the entire schedule area */
.panel-results.show-charts #rent-schedule {
    display: none !important;
}

/* When Schedule view is active, show it */
.panel-results.show-schedule #rent-schedule {
    display: block;
}

/* Results header bar: Landlord/Tenant + view toggle aligned */
.results-topbar {
    display: flex;
    align-items: center;
    gap: 12px;
    margin: 6px 0 14px;
    flex-wrap: wrap;
}

/* Chart header: title + small control cluster, left-aligned */
.chart-header {
    display: flex;
    align-items: center;
    gap: 10px;
    /* space between title and buttons */
    margin-bottom: 8px;
}

/* put the control bars on the left */
#scheduleControls,
#chartsControls {
    display: flex;
    /* make the bar a flex row */
    justify-content: flex-start;
    /* push buttons to the left edge */
    gap: 8px;
    /* spacing between clusters/buttons */
    margin: 8px 0 14px;
    /* some breathing room under the KPI cards */
    width: 100%;
    /* span the full row so "right" is the page edge */
}

/* inside schedule controls, the 3 buttons should sit inline with spacing */
#scheduleControls .toggle-group {
    display: inline-flex;
    justify-content: flex-end;
    /* push buttons to the right side */
    gap: 8px;
}

/* optional: on small screens, center them so they don’t hug the edge */
@media (max-width: 900px) {

    #scheduleControls,
    #chartsControls {
        justify-content: center;
    }
}

/* Hide charts & inline controls by default; show only in charts view */
.panel-results .inline-controls {
    display: none;
    gap: 8px;
    margin-bottom: 10px;
}

.panel-results.show-charts .inline-controls {
    display: flex;
}

.panel-results.show-schedule #analysis-charts {
    display: none;
}

.panel-results.show-charts #analysis-charts {
    display: grid;
}

.panel-results.show-charts #rent-schedule,
.panel-results.show-charts .toggle-group[data-view="monthly"],
.panel-results.show-charts .toggle-group [data-view="annual"],
.panel-results.show-charts .toggle-group [data-view="monthly_sub"] {
    /* schedule UI hidden when charts are up */
    display: none !important;
}

.card {
    background: var(--card);
    border: 1px solid var(--stroke);
    border-radius: 18px;
    padding: 16px;
    box-shadow: var(--shadow);
    transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
}

.card-label {
    color: var(--muted);
    font-weight: 600;
    margin-bottom: 6px;
}

.card-value {
    font-feature-settings: "tnum" 1, "lnum" 1;
    font-variant-numeric: tabular-nums;
    font-size: 28px;
    font-weight: 800;
}

.card-sub {
    color: var(--muted);
    font-size: .9rem;
    margin-top: 4px;
}

/* Align "Annual Increase (%)" directly over the second column inputs */
.two-col label.right {
    text-align: left;
    justify-self: start;
}

/* Year row visual polish */
.year-row td {
    padding: 10px 12px;
}

.yr-left {
    font-weight: 700;
}

/* Center Lease Year column in Annual view */
.annual-view th:first-child,
.annual-view td:first-child {
    text-align: center;
}

/* Subtotal rows styling for monthly+subtotals */
.subtotal-row {
    background: rgba(255, 255, 255, .06);
    font-weight: 700;
}

.subtotal-row td {
    border-top: 1px solid rgba(255, 255, 255, .14);
}

/* Monthly + Subtotals only */
.monthly-sub-view thead th:first-child {
    text-align: center;
}

/* Center the first column (Year) for normal rows */
.monthly-sub-view tbody tr:not(.subtotal-row) td:first-child {
    text-align: center;
}

/* Keep subtotal row's first cell left-aligned */
.monthly-sub-view tbody tr.subtotal-row td:first-child {
    text-align: left;
}

/* --- NEW: OpEx row wrapper (Taxes/CAM/Insurance) --- */
.opx {
    grid-column: 1 / -1;
    /* span all 4 columns of the main grid */
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 16px;
}

/* children inside the OpEx sub-grid */
.opx .col-1-2 {
    grid-column: 1 / span 2;
}

/* left half */
.opx .col-3-4 {
    grid-column: 3 / span 2;
}

/* right half */

/* checkbox row must sit under columns 1–2 */
.opx .service-include {
    grid-column: 1 / span 2;
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 6px;
}

.opx .service-include input {
    margin: 0;
}

/* Pass-through mode & Base-year override rows live in the OpEx sub-grid */
.opx .opx-mode,
.opx .opx-base {
    grid-column: 1 / span 2;
    /* right half under the growth controls */
}

@media (max-width: 900px) {

    .opx .opx-mode,
    .opx .opx-base {
        grid-column: 1 / -1;
    }
}

.seg {
    display: inline-flex;
    gap: 8px;
}

.seg label {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    border: 1px solid var(--stroke);
    border-radius: 999px;
    background: var(--panel-2);
    cursor: pointer;
}

.seg input {
    appearance: none;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    border: 2px solid var(--stroke);
    background: transparent;
    display: inline-block;
}

.seg input:checked {
    background: var(--accent);
    border-color: var(--accent);
}

[data-abate] {
    display: none;
}

/* default hidden; JS will show based on pattern */

/* Optional: tint rows that are gross-abated */
tr td.gross-abated {
    opacity: .7;
}

/* ===== Chart theming + grid ===== */
:root {
    /* tweak these to exactly match your KPI palette */
    --surface-1: #12161c;
    --surface-2: #171c24;
    --card-border: rgba(255, 255, 255, .08);

    --text-1: #e8eef7;
    /* primary text */
    --text-2: #a0acba;
    /* secondary text / legend */
    --grid-1: rgba(255, 255, 255, .10);
    /* chart gridlines */

    --accent-blue: #3b82f6;
    /* Base/Net */
    --accent-gold: #f59e0b;
    /* Taxes */
    --accent-green: #22c55e;
    /* CAM */
    --accent-rose: #f43f5e;
    /* Insurance */
    --accent-slate: #93c5fd;
    /* 2nd series / landlord etc. */
}

/* Card container for charts (reuses your card look) */
.chart-card {
    background: var(--surface-2);
    border: 1px solid var(--card-border);
    border-radius: 16px;
    padding: 16px 16px 8px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, .25);
}

.chart-card h3 {
    margin: 0 0 10px;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-2);
    letter-spacing: .02em;
}

/* Fixed-height canvas wrapper; Chart.js is responsive */
.chart-wrap {
    position: relative;
    height: 320px;
}

.chart-wrap.short {
    height: 180px;
}

/* 2×2 grid (1 col on small, 2 cols ≥ 900px) */
.charts-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 16px;
}

@media (min-width: 900px) {
    .charts-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
    }
}

/* Make abatement timeline full width on all sizes */
.charts-grid .full {
    grid-column: 1 / -1;
}

html,
body {
    overflow-x: hidden;
}

/* prevent horizontal scroll from tiny overflows */

.charts-grid {
    display: grid;
    gap: 12px;
    grid-template-columns: repeat(2, 1fr);
    margin: 12px 0 6px;
}

.chart-card {
    border: 1px solid #e5e7eb;
    border-radius: 10px;
    padding: 8px;
}

.chart-card img {
    width: 100%;
    height: auto;
    display: block;
}

.chart-card figcaption {
    font-size: 9pt;
    color: #6b7280;
    margin-top: 6px;
}

.container.one-col {
    margin-left: auto;
    /* explicit centering */
    margin-right: auto;
}

/* Put the checkbox directly under the commission input, flush-left */
#brokerCommField {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    /* ensures left edges line up */
    gap: 8px;
    /* space between the input and the checkbox row */
}

#brokerCommField .inline-check {
    display: inline-flex;
    align-items: center;
    /* vertically centers box with text */
    gap: 8px;
    margin: 0;
    /* no extra left or top margin */
    padding: 0;
}

/* kill any global transforms/margins that nudge checkboxes */
#brokerCommField .inline-check input[type="checkbox"] {
    margin: 0 8px 0 0;
    /* only a small gap to the label text */
    transform: none;
    position: static;
    vertical-align: middle;
}

#brokerCommField .inline-check input {
    margin: 0 8px 0 0;
    /* only a small gap to the label text */
}

#brokerCommField .inline-check span {
    white-space: nowrap;
    /* keep text on one line */
}

#brokerCommField .inline-check input {
    margin: 0 8px 0 0;
    /* tidy space before text */
}

#brokerCommField .inline-check span {
    white-space: nowrap;
    /* keep text on one line */
}


/* commission checkbox sits flush under the input */
#brokerCommField>.inline-check {
    margin-left: 0;
    padding-left: 0;
}

/* 4-up grid for scenarios; falls back responsively */
.compare-grid {
    display: grid;
    grid-template-columns: repeat(4, minmax(260px, 1fr));
    gap: 16px;
}

/* Tablet: 2 columns */
@media (max-width: 1100px) {
    .compare-grid {
        grid-template-columns: repeat(2, minmax(260px, 1fr));
    }
}

/* Phone: 1 column */
@media (max-width: 640px) {
    .compare-grid {
        grid-template-columns: 1fr;
    }
}

/* Optional: subtle color accents per scenario number */
.badge {
    background: var(--panel-2);
    border-radius: 999px;
    padding: 2px 10px;
    font-weight: 600;
}

.badge-1 {
    --badge: #8ab4f8;
}

.badge-2 {
    --badge: #80cbc4;
}

.badge-3 {
    --badge: #f6a9a9;
}

.badge-4 {
    --badge: #f8d786;
}

.badge-5 {
    --badge: #cfa6f8;
}

.badge-6 {
    --badge: #a5d6a7;
}

.badge-7 {
    --badge: #ffccbc;
}

.badge-8 {
    --badge: #b3e5fc;
}

.badge-1,
.badge-2,
.badge-3,
.badge-4,
.badge-5,
.badge-6,
.badge-7,
.badge-8 {
    box-shadow: 0 0 0 2px var(--badge) inset;
}


.cmp-col {
    background: #14181d;
    border: 1px solid #2a2f36;
    border-radius: 12px;
    padding: 10px;
}

.cmp-col.empty .cmp-empty {
    padding: 18px;
    color: #9aa3ad;
    text-align: center;
    border: 1px dashed #374151;
    border-radius: 10px;
}

.cmp-col-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.badge {
    font-weight: 700;
    padding: 4px 8px;
    border-radius: 999px;
}

.badge-A {
    background: #1e3a8a;
    color: #93c5fd;
}

.badge-B {
    background: #7f1d1d;
    color: #fecaca;
}

.badge-C {
    background: #064e3b;
    color: #a7f3d0;
}

.cmp-actions .cmp-btn {
    margin-left: 6px;
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid #374151;
    background: #1f2430;
    color: #dbe3ea;
}

.cmp-kpis {
    display: grid;
    grid-template-columns: 1fr;
    gap: 8px;
}

.cmp-card {
    background: #0f1216;
    border: 1px solid #2a2f36;
    border-radius: 10px;
    padding: 10px;
}

.cmp-k {
    font-size: 12px;
    color: #9aa3ad;
}

.cmp-v {
    font-size: 18px;
    font-weight: 700;
}

.cmp-charts {
    margin-top: 10px;
    display: grid;
    gap: 10px;
}

.cmp-fig {
    margin: 0;
}

.cmp-fig img {
    width: 100%;
    border-radius: 10px;
    border: 1px solid #2a2f36;
}

.cmp-fig figcaption {
    font-size: 12px;
    color: #9aa3ad;
    margin-top: 4px;
}

/* --- Scenario compare buttons --- */
.cmp-actions {
    display: flex;
    gap: 8px;
}

.cmp-btn {
    position: relative;
    display: inline-flex;
    align-items: center;
    gap: .5rem;
    padding: .45rem;
    border-radius: 999px;
    background: #2b2f36;
    color: #e6ebf1;
    border: 1px solid #3a404a;
    font-weight: 600;
    line-height: 1;
    cursor: pointer;
    transition: transform .06s ease, filter .15s ease, background .15s ease, border-color .15s ease;
}

.cmp-btn:hover {
    filter: brightness(1.08);
    border-color: #4a5260;
}

.cmp-btn:active {
    transform: translateY(1px) scale(.99);
}

.cmp-btn .busy-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #7aa2ff;
    opacity: 0;
    transform: scale(.6);
    transition: opacity .15s, transform .15s;
}

.cmp-btn.pulse .busy-dot {
    opacity: 1;
    transform: scale(1);
}

/* ripple */
.cmp-btn .ripple {
    position: absolute;
    inset: auto;
    border-radius: 50%;
    background: rgba(255, 255, 255, .12);
    transform: scale(0);
    animation: cmp-ripple .6s ease-out forwards;
    pointer-events: none;
}

@keyframes cmp-ripple {
    to {
        transform: scale(2.6);
        opacity: 0;
    }
}

/* scenario action buttons */
.cmp-actions .cmp-btn {
    position: relative;
    overflow: hidden;
    --btn-bg: #232a33;
    --btn-bg-hover: #2c3642;
    --btn-fg: #e7edf5;
    --btn-ring: rgba(227, 30, 36, .45);
    background: var(--btn-bg);
    color: var(--btn-fg);
    border: 1px solid #2f3a45;
    border-radius: 10px;
    padding: 8px 12px;
    font-weight: 600;
    transition: .18s transform, .2s background, .2s border-color;
}

.cmp-actions .cmp-btn:hover {
    background: var(--btn-bg-hover);
    transform: translateY(-1px);
    border-color: #3a4756;
}

.cmp-actions .cmp-btn:active {
    transform: translateY(0);
}

.cmp-actions .cmp-btn .busy-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    margin-left: 8px;
    background: #7aa2ff;
    opacity: 0;
    transition: .2s;
}

.cmp-actions .cmp-btn.pulse .busy-dot {
    opacity: 1;
    box-shadow: 0 0 0 6px rgba(122, 162, 255, .15);
}

/* ripple */
.cmp-actions .cmp-btn .ripple {
    position: absolute;
    border-radius: 999px;
    pointer-events: none;
    background: var(--btn-ring);
    transform: scale(0);
    animation: rip .5s ease-out forwards;
}

@keyframes rip {
    to {
        transform: scale(1);
        opacity: 0;
    }
}

/* === Pins 1–8 row (top of Results) ====================================== */
/* Works even if you didn't wrap them; targets any id that starts with pin */
[id^="pin"].pill {
    min-width: 48px;
    height: 32px;
    padding: 0 12px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    border-radius: 999px;
    text-align: center;
}

[id^="pin"].pill .ripple {
    animation-duration: .45s;
}

/* feels snappier */

/* === Compare section ===================================================== */
/* You already switched the grid to 4 columns; keep + tighten spacing */
.compare-grid {
    grid-template-columns: repeat(4, minmax(280px, 1fr));
    gap: 16px;
}

/* desktop */
/* fallbacks */
@media (max-width: 1320px) {
    .compare-grid {
        grid-template-columns: repeat(3, minmax(260px, 1fr));
    }
}

@media (max-width: 980px) {
    .compare-grid {
        grid-template-columns: repeat(2, minmax(260px, 1fr));
    }
}

@media (max-width: 640px) {
    .compare-grid {
        grid-template-columns: 1fr;
    }
}

/* Scenario header + actions */
.cmp-col-header {
    align-items: center;
    gap: 10px;
}

.cmp-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    justify-content: flex-end;
}

/* Compact, consistent buttons inside scenario cards */
.cmp-actions .cmp-btn {
    height: 32px;
    padding: 0 10px;
    font-size: 13px;
    border-radius: 8px;
    line-height: 32px;
    /* perfect vertical centering */
}

.cmp-actions .cmp-btn .btn-label {
    white-space: nowrap;
}

/* Subtle role cues (optional) */
.cmp-actions .cmp-btn[data-act="load"] {
    --btn-bg: #232a33;
    --btn-bg-hover: #2c3642;
}

.cmp-actions .cmp-btn[data-act="dup"] {
    --btn-bg: #212733;
    --btn-bg-hover: #293142;
}

.cmp-actions .cmp-btn[data-act="clear"] {
    --btn-bg: #2a1e1e;
    --btn-bg-hover: #3a2828;
    border-color: #523737;
}

.cmp-actions .cmp-btn[data-act="pin"] {
    --btn-bg: #202833;
    --btn-bg-hover: #283244;
}

/* Scenario number badges (1–8) – light accent ring */
.badge {
    background: var(--panel-2);
    border-radius: 999px;
    padding: 2px 10px;
    font-weight: 600;
}

.badge-1 {
    --badge: #8ab4f8
}

.badge-2 {
    --badge: #80cbc4
}

.badge-3 {
    --badge: #f6a9a9
}

.badge-4 {
    --badge: #f8d786
}

.badge-5 {
    --badge: #cfa6f8
}

.badge-6 {
    --badge: #a5d6a7
}

.badge-7 {
    --badge: #ffccbc
}

.badge-8 {
    --badge: #b3e5fc
}

.badge-1,
.badge-2,
.badge-3,
.badge-4,
.badge-5,
.badge-6,
.badge-7,
.badge-8 {
    box-shadow: 0 0 0 2px var(--badge) inset;
}

/* --- Interactions for the top-bar pills (Pin A/B/C & Compare) --- */
.pill {
    /* you already have .pill – we add a few bits */
    position: relative;
    overflow: hidden;
    transition: transform .12s ease, filter .15s ease, background .15s ease, border-color .15s ease;
}

.pill:hover {
    filter: brightness(1.08);
}

.pill:active {
    transform: translateY(1px);
}

/* momentary “flash” after a pin (set by JS and removed after 400ms) */
.pill.active {
    box-shadow: 0 0 0 3px rgba(255, 255, 255, .08) inset;
}

.pill-A.active {
    background: #3b82f6;
    color: #fff;
    border-color: transparent;
    box-shadow: 0 6px 18px rgba(59, 130, 246, .28);
}

.pill-B.active {
    background: #ef4444;
    color: #fff;
    border-color: transparent;
    box-shadow: 0 6px 18px rgba(239, 68, 68, .28);
}

.pill-C.active {
    background: #10b981;
    color: #062;
    border-color: transparent;
    box-shadow: 0 6px 18px rgba(16, 185, 129, .28);
}

/* Compare toggle – persistent “on” look using aria-pressed */
#toggleCompare[aria-pressed="true"] {
    background: var(--lee-red);
    color: #fff;
    border-color: transparent;
    box-shadow: 0 6px 18px rgba(200, 16, 46, .35);
}

/* ripple for pills (reuses the ripple animation used in scenarios buttons) */
.pill .ripple {
    position: absolute;
    border-radius: 999px;
    pointer-events: none;
    background: rgba(255, 255, 255, .14);
    transform: scale(0);
    animation: rip .5s ease-out forwards;
}

@keyframes rip {
    to {
        transform: scale(1);
        opacity: 0;
    }
}

/* Property photo uploader */
.photo-row {
    display: flex;
    gap: .75rem;
    align-items: center;
}

.photo-preview {
    margin-top: .5rem;
    border: 1px solid var(--surface-2);
    border-radius: 12px;
    padding: 6px;
    max-width: 560px;
    background: var(--surface-1);
}

.photo-preview img {
    display: block;
    width: 100%;
    height: auto;
    border-radius: 10px;
}

.cmp-photo {
    margin: 8px 0 12px;
}

.cmp-photo img {
    width: 100%;
    max-height: 160px;
    object-fit: cover;
    border-radius: 12px;
    display: block;
}



/* Breathing room below the details when open (modern browsers) */
.field:has(#capexDetails[open]) {
    margin-bottom: 28px;
    transition: margin .15s ease;
}

/* --- Scenario header --------------------------------------------------- */
.cmp-col-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    padding: 6px 8px 0;
}

/* Two-line badge: small "Scenario" + centered number underneath */
.badge {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 4px 12px 6px;
    min-width: 72px;
    /* keeps a nice circle-ish look */
    line-height: 1;
    border-radius: 999px;
    background: var(--panel-2);
    box-shadow: 0 0 0 2px var(--badge, #6aa9ff) inset;
    /* you already set --badge per 1..8 */
}

.badge .b-top {
    font-size: 12px;
    opacity: .9;
    letter-spacing: .2px;
}

.badge .b-num {
    font-size: 18px;
    font-weight: 700;
    margin-top: 2px;
}

/* Actions always on one row; compact buttons */
.cmp-actions {
    display: flex;
    gap: 8px;
    flex-wrap: nowrap;
    /* don't wrap to a new line */
}

.cmp-actions .cmp-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 28px;
    padding: 0 10px;
    font-size: 12px;
    border-radius: 8px;
    line-height: 28px;
    white-space: nowrap;
}

/* (optional) subtle roles */
.cmp-actions .cmp-btn[data-act="load"] {
    --btn-bg: #232a33;
    --btn-bg-hover: #2c3642;
}

.cmp-actions .cmp-btn[data-act="dup"] {
    --btn-bg: #212733;
    --btn-bg-hover: #293142;
}

.cmp-actions .cmp-btn[data-act="clear"] {
    --btn-bg: #2a1e1e;
    --btn-bg-hover: #3a2828;
    border-color: #523737;
}

/* Header bar for compare */
.compare-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
}

.count-ctrl {
    display: flex;
    align-items: center;
    gap: 8px;
    opacity: .9;
}

.count-ctrl select {
    height: 28px;
    padding: 0 8px;
    border-radius: 8px;
    background: var(--panel-2);
    color: var(--text);
    border: 1px solid var(--stroke);
}

/* Grid uses a CSS var for number of columns; we’ll set it from JS */
.compare-grid {
    display: grid;
    grid-template-columns: repeat(var(--cols, 4), minmax(280px, 1fr));
    gap: 16px;
}

/* Actions row stays on one line, compact buttons */
.cmp-actions {
    display: flex;
    gap: 8px;
    flex-wrap: nowrap;
}

.cmp-actions .cmp-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 28px;
    padding: 0 10px;
    font-size: 12px;
    border-radius: 8px;
    line-height: 28px;
    white-space: nowrap;
}

.cmp-btn[disabled] {
    opacity: .5;
    cursor: not-allowed;
    filter: saturate(.7);
}

/* Two-line badge (already added earlier, included here for clarity) */
.badge {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 4px 12px 6px;
    min-width: 72px;
    border-radius: 999px;
    background: var(--panel-2);
    box-shadow: 0 0 0 2px var(--badge, #6aa9ff) inset;
}

.badge .b-top {
    font-size: 12px;
    opacity: .9;
    letter-spacing: .2px;
}

.badge .b-num {
    font-size: 18px;
    font-weight: 700;
    margin-top: 2px;
}

/* The grid already uses --cols; we also add a helper class .cols-4 via JS */
.compare-grid {
    display: grid;
    grid-template-columns: repeat(var(--cols, 4), minmax(280px, 1fr));
    gap: 16px;
}

/* When showing 4-up, tighten the actions row so it fits */
.compare-grid.cols-4 .cmp-actions {
    gap: 6px;
}

.compare-grid.cols-4 .cmp-actions .cmp-btn {
    padding: 0 8px;
    height: 26px;
    line-height: 26px;
    font-size: 11px;
}

/* For EMPTY cards at 4-up, allow the “Pin” button to wrap to a second line */
.compare-grid.cols-4 .cmp-col.empty .cmp-actions {
    flex-wrap: wrap;
    row-gap: 6px;
}

/* Compare header */
.compare-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
}

.count-ctrl {
    display: flex;
    align-items: center;
    gap: 8px;
    opacity: .9;
}

.count-ctrl select {
    height: 28px;
    padding: 0 8px;
    border-radius: 8px;
    background: var(--panel-2);
    color: var(--text);
    border: 1px solid var(--stroke);
}

/* 3 columns per row, always. JS sets --cols but we clamp to 3 here. */
.compare-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(280px, 1fr));
    gap: 16px;
}

/* Responsive collapse: 2-up on medium screens, 1-up on narrow */
@media (max-width: 1200px) {
    .compare-grid {
        grid-template-columns: repeat(2, minmax(280px, 1fr));
    }
}

@media (max-width: 700px) {
    .compare-grid {
        grid-template-columns: 1fr;
    }
}

/* Action buttons (kept compact and on one row) */
.cmp-actions {
    display: flex;
    gap: 8px;
    flex-wrap: nowrap;
}

.cmp-actions .cmp-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 28px;
    line-height: 28px;
    padding: 0 10px;
    font-size: 12px;
    border-radius: 8px;
    white-space: nowrap;
}

.cmp-btn[disabled] {
    opacity: .5;
    cursor: not-allowed;
    filter: saturate(.7);
}

/* Badge ring for #9 (add to your existing 1–8 accents) */
.badge-9 {
    --badge: #ffd1e0;
}

/* Base style for the top-row pin pills */
[id^="pin"].pill {
    --accent: var(--stroke);
    --pill-bg: linear-gradient(180deg, var(--panel-2) 0%, var(--panel) 100%);
    --pill-shadow: 0 1px 0 rgba(0, 0, 0, .25), 0 6px 18px rgba(0, 0, 0, .18);
    padding: 6px 12px;
    min-width: 56px;
    height: 34px;
    border-radius: 999px;
    border: 1px solid var(--accent);
    background: var(--pill-bg);
    box-shadow: var(--pill-shadow);
    font-weight: 700;
    letter-spacing: .1px;
    transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease;
}

[id^="pin"].pill:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 0 rgba(0, 0, 0, .25), 0 10px 26px rgba(0, 0, 0, .22);
    border-color: color-mix(in srgb, var(--accent), #8ab4f8 45%);
}

[id^="pin"].pill:active {
    transform: translateY(0);
}

/* Filled (there’s a scenario saved to that slot). JS sets [data-filled="true"] */
[id^="pin"].pill[data-filled="true"] {
    box-shadow: inset 0 0 0 2px var(--accent), 0 1px 0 rgba(0, 0, 0, .25), 0 6px 18px rgba(0, 0, 0, .18);
}

/* Tiny pin icon via CSS mask – no markup change needed */
[id^="pin"].pill::before {
    content: "";
    width: 12px;
    height: 12px;
    margin-right: 6px;
    display: inline-block;
    background: currentColor;
    -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M14 5V3H6v2h2v6l-2 2v2h8v-2l-2-2V5h2zM9 21h2v-2H9v2z"/></svg>') no-repeat center / 100% 100%;
    mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M14 5V3H6v2h2v6l-2 2v2h8v-2l-2-2V5h2zM9 21h2v-2H9v2z"/></svg>') no-repeat center / 100% 100%;
}

/* Accent ring per slot (matches your scenario accent colors) */
#pin1 {
    --accent: #8ab4f8
}

#pin2 {
    --accent: #80cbc4
}

#pin3 {
    --accent: #f6a9a9
}

#pin4 {
    --accent: #f8d786
}

#pin5 {
    --accent: #cfa6f8
}

#pin6 {
    --accent: #a5d6a7
}

#pin7 {
    --accent: #ffccbc
}

#pin8 {
    --accent: #b3e5fc
}

#pin9 {
    --accent: #ffd1e0
}

/* Make the in-card pin button look like a primary/outline pill */
.cmp-actions .cmp-btn[data-act="pin"] {
    --accent: var(--badge, #8ab4f8);
    height: 30px;
    padding: 0 12px;
    border-radius: 999px;
    border: 1px solid color-mix(in srgb, var(--accent), white 25%);
    background: linear-gradient(180deg, color-mix(in srgb, var(--panel-2), var(--accent) 6%), var(--panel));
    box-shadow: inset 0 0 0 2px color-mix(in srgb, var(--accent), transparent 60%);
    font-weight: 700;
}

.cmp-col.empty .cmp-actions .cmp-btn[data-act="pin"] {
    /* a touch more pop for empty slots so the call-to-action stands out */
    box-shadow: inset 0 0 0 2px color-mix(in srgb, var(--accent), transparent 35%);
}

.cmp-actions .cmp-btn[data-act="pin"]::before {
    content: "";
    width: 12px;
    height: 12px;
    margin-right: 6px;
    display: inline-block;
    background: currentColor;
    -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M14 5V3H6v2h2v6l-2 2v2h8v-2l-2-2V5h2zM9 21h2v-2H9v2z"/></svg>') no-repeat center / 100% 100%;
    mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M14 5V3H6v2h2v6l-2 2v2h8v-2l-2-2V5h2zM9 21h2v-2H9v2z"/></svg>') no-repeat center / 100% 100%;
}

/* === Lease Comparison: cash-flow grid =============================== */
.cf {
    margin-top: 10px;
    border-radius: 10px;
    background: var(--panel-2);
    border: 1px solid var(--stroke);
    overflow: hidden;
}

.cf-toolbar {
    display: flex;
    gap: 10px;
    align-items: center;
    justify-content: flex-end;
    padding: 8px 10px;
    background: var(--panel);
    border-bottom: 1px solid var(--stroke);
}

.cf-toolbar .mini {
    height: 28px;
    border-radius: 8px;
    border: 1px solid var(--stroke);
    background: var(--panel-2);
    color: var(--text);
    padding: 0 8px;
    font-size: 12px;
}

.cf-wrap {
    overflow-x: auto;
    position: relative;
    /* horizontal scroll host */
}

.cf-table {
    display: grid;
    grid-template-columns: 220px auto;
    /* sticky left + columns wrapper */
    min-width: 720px;
}

.cf-left {
    position: sticky;
    left: 0;
    z-index: 2;
    background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
    border-right: 1px solid var(--stroke);
}

.cf-left .cf-hdr {
    font-weight: 700;
    padding: 10px 12px;
    border-bottom: 1px solid var(--stroke);
}

.cf-left .cf-row {
    padding: 10px 12px;
    border-bottom: 1px dashed var(--stroke);
    white-space: nowrap;
}

.cf-cols {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: minmax(120px, 1fr);
}

.cf-cols .col {
    border-left: 1px solid var(--stroke);
}

.cf-head {
    position: sticky;
    top: 0;
    z-index: 1;
    background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
    border-bottom: 1px solid var(--stroke);
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: minmax(120px, 1fr);
}

.cf-head .y {
    padding: 10px 8px;
    font-weight: 700;
    text-align: right;
}

.cf-cell {
    padding: 10px 8px;
    text-align: right;
    border-bottom: 1px dashed var(--stroke);
}

.cf-total {
    background: rgba(255, 255, 255, .02);
    font-weight: 700;
}

.cf-neg {
    color: var(--red-400, #ff6b6b);
}

.cf-pos {
    color: var(--green-400, #60d394);
}

/* smaller on narrow widths */
@media (max-width: 1200px) {
    .cf-table {
        min-width: 660px;
    }

    .cf-head .y,
    .cf-cell {
        font-size: 13px;
    }
}

/* simple, card-aligned horizontal compare table */
.cf-compare .cf-card {
    background: var(--panel-2);
    border: 1px solid var(--stroke);
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: 12px 12px 6px;
    margin-bottom: 14px;
}

.cf-compare h4 {
    margin: 0 0 8px;
    font-size: 14px;
    color: var(--text-2);
}

.cf-compare table {
    width: 100%;
    border-collapse: collapse;
}

.cf-compare th,
.cf-compare td {
    padding: 6px 8px;
    text-align: right;
    white-space: nowrap;
}

.cf-compare th:first-child,
.cf-compare td:first-child {
    text-align: left;
    color: var(--text-2);
}

.cf-compare thead th {
    border-bottom: 1px solid var(--stroke);
}

.cf-compare tfoot td {
    border-top: 1px solid var(--stroke);
    font-weight: 700;
}

/* === Horizontal comparison rows ======================================= */
.compare-grid {
    /* becomes a vertical stack of rows */
    display: grid;
    grid-template-columns: 1fr;
    gap: 18px;
}

.scenario-row {
    display: flex;
    gap: 18px;
    background: var(--surface-2);
    border: 1px solid var(--border-1);
    border-radius: 14px;
    padding: 14px;
    box-shadow: var(--shadow-1);
}

/* Left rail: photo + KPIs */
.scenario-left {
    width: 320px;
    flex: 0 0 320px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.scenario-left .photo {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 10px;
    background: #111;
    border: 1px solid var(--border-1);
}

.kpi-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.kpi-chip {
    background: var(--surface-3);
    border: 1px solid var(--border-1);
    border-radius: 10px;
    padding: 10px 12px;
    line-height: 1.15;
}

.kpi-chip .label {
    color: var(--text-2);
    font-size: 12px;
}

.kpi-chip .value {
    font-weight: 700;
    margin-top: 4px;
}

/* Toolbar (Load / Duplicate / Clear / Pin) */
.scenario-toolbar {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.pin-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    border: 1px solid var(--accent-3);
    background: var(--accent-1);
    color: var(--accent-7);
    border-radius: 999px;
    padding: 6px 10px;
    font-weight: 600;
}

.pin-btn .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--accent-6);
}

/* Right side: horizontally scrollable yearly table */
.scenario-right {
    min-width: 0;
    /* allow overflow container to size correctly */
    flex: 1 1 auto;
    overflow: auto;
    border: 1px solid var(--border-1);
    border-radius: 10px;
    background: var(--surface-1);
}

.cf-mini {
    width: max(620px, 100%);
    border-collapse: separate;
    border-spacing: 0;
}

.cf-mini thead th {
    position: sticky;
    top: 0;
    background: var(--surface-1);
    z-index: 1;
    padding: 10px 12px;
    font-weight: 700;
    text-align: right;
    border-bottom: 1px solid var(--border-1);
}

.cf-mini thead th:first-child,
.cf-mini tbody th:first-child {
    text-align: left;
}

.cf-mini tbody th,
.cf-mini tbody td {
    padding: 8px 12px;
    border-bottom: 1px solid var(--border-1);
    white-space: nowrap;
    text-align: right;
}

.subtotal-toggle .chevron {
    display: inline-block;
    transition: transform .18s ease;
    transform: rotate(0deg);
}

.subtotal-toggle.expanded .chevron {
    transform: rotate(180deg);
}

.cf-mini tfoot td {
    padding: 10px 12px;
    border-top: 1px solid var(--border-1);
    font-weight: 700;
    text-align: right;
}

/* small badge above each row */
.scenario-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid var(--border-2);
    background: var(--surface-3);
    font-weight: 700;
    margin-bottom: 6px;
}

.scenario-badge .num {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: grid;
    place-items: center;
    background: var(--surface-4);
    font-size: 12px;
    font-weight: 800;
}

/* === Results layout (rows) =============================================== */
/* Make the whole Results panel a 2-column header grid */
.panel-results {
    display: grid;
    grid-template-columns: 1fr auto;
    /* left: title, right: landlord/tenant */
    grid-auto-rows: min-content;
    align-items: center;
    margin-top: 28px;
    gap: 8px 12px;
}

/* Row 1: Title (left) + Landlord/Tenant (right) */
.panel-results .panel-title {
    grid-column: 1;
    grid-row: 1;
    margin: 0;
    /* pulls it up to the top bar */
}

#perspectiveToggles {
    grid-column: 2;
    grid-row: 1;
    justify-self: end;
}

/* Row 2: the three view buttons */
#resultsViewToggle {
    grid-column: 1 / -1;
    grid-row: 2;
}

/* Row 3 & 4: KPI cards — 5 across on wide screens, wrap as needed */
.panel-results .cards {
    grid-column: 1 / -1;
    grid-row: 3;
    display: grid;
    gap: 12px;
    grid-template-columns: repeat(4, minmax(0, 1fr));
}

@media (max-width: 1500px) {
    .panel-results .cards {
        grid-template-columns: repeat(4, 1fr);
    }
}

@media (max-width: 1100px) {
    .panel-results .cards {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 560px) {
    .panel-results .cards {
        grid-template-columns: 1fr;
    }
}

/* Row 5: monthly/annual/subtotals control bar */
#scheduleControls {
    grid-column: 1 / -1;
    grid-row: 4;
}

/* Flatten the existing wrapper so its children (the two groups)
     can participate in the grid rows above. */
.results-topbar {
    display: contents;
}

/* ========== Results view pills (Rent Schedule / Charts / Lease Comparison) ========== */

/* Container spacing + layout */
.view-pills {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin: 4px 0 14px;
    /* sits neatly under the “Results” title */
}

/* Base pill — same vibe as Landlord/Tenant */
.btn-pill {
    -webkit-tap-highlight-color: transparent;
    appearance: none;
    border: 1px solid var(--stroke);
    background: var(--panel-2);
    color: var(--text-2);
    padding: 6px 12px;
    line-height: 1;
    border-radius: 9999px;
    font-weight: 600;
    font-size: 13.5px;
    letter-spacing: .2px;
    box-shadow: var(--shadow-xs, 0 1px 0 rgba(0, 0, 0, .25));
    transition: background .15s ease, color .15s ease, border-color .15s ease, box-shadow .15s ease, transform .02s ease;
}

.btn-pill:hover {
    background: var(--panel-3);
    color: var(--text-1);
}

.btn-pill:active {
    transform: translateY(0.5px);
}

/* Active state — bright pill, white text, no border */
.btn-pill.active {
    color: #fff;
    border-color: transparent;
    box-shadow:
        0 6px 18px rgba(0, 0, 0, .25),
        inset 0 -2px 0 rgba(255, 255, 255, .15);
}

/* Per-view accent colors when active.
     Adjust to match your palette. */
.btn-pill.active[data-view="schedule"] {
    background: #3b82f6;
    /* blue 500 */
}

.btn-pill.active[data-view="charts"] {
    background: #6d28d9;
    /* indigo 700 */
}

.btn-pill.active[data-view="compare"] {
    background: #ef4444;
    /* red 500 – complements “Landlord” */
}

/* Keyboard focus ring */
.btn-pill:focus-visible {
    outline: 2px solid rgba(59, 130, 246, .85);
    /* blue focus */
    outline-offset: 2px;
}

/* If you prefer one unified accent (no per-view colors), comment the
     three view-specific blocks above and use this instead: */
/*
  .btn-pill.active {
    background: var(--accent, #3b82f6);
  }
  */
/* --- Scenario row accent plumbing -------------------------------------- */
.scenario-row {
    position: relative;
    border-radius: 14px;
    background: var(--panel-2, #121418);
    border: 1px solid var(--panel-border, rgba(255, 255, 255, .06));
    overflow: hidden;
}

/* slim accent bar down the left using the per-row --accent color */
.scenario-row::before {
    content: "";
    position: absolute;
    inset: 0 auto 0 0;
    width: 4px;
    background: var(--accent, #6ea8fe);
    opacity: .9;
}

/* --- Badge -------------------------------------------------------------- */
.scenario-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 10px;
    border-radius: 999px;
    font-weight: 600;
    background: color-mix(in oklab, var(--accent, #6ea8fe) 16%, transparent);
    border: 1px solid color-mix(in oklab, var(--accent, #6ea8fe) 55%, transparent);
}

.scenario-badge span:first-child {
    color: var(--text-2, #c7cbd4);
    letter-spacing: .2px;
}

.scenario-badge .num {
    display: grid;
    place-items: center;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: var(--accent, #6ea8fe);
    color: #0a0c10;
    font-weight: 800;
    font-variant-numeric: tabular-nums;
    line-height: 1;
}

/* --- Pin button --------------------------------------------------------- */
.scenario-toolbar .pin-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 7px 12px;
    border-radius: 999px;
    border: 1px solid var(--accent, #6ea8fe);
    color: var(--accent, #6ea8fe);
    background: transparent;
    font-weight: 600;
    transition: transform .15s ease, background-color .15s ease, color .15s ease, border-color .15s ease;
}

.scenario-toolbar .pin-btn .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--accent, #6ea8fe);
}

/* hover/focus */
.scenario-toolbar .pin-btn:hover {
    transform: translateY(-1px);
    background: color-mix(in oklab, var(--accent, #6ea8fe) 12%, transparent);
}

/* pinned state */
.scenario-toolbar .pin-btn.pinned {
    background: var(--accent, #6ea8fe);
    color: #0a0c10;
    border-color: var(--accent, #6ea8fe);
}

.scenario-toolbar .pin-btn.pinned .dot {
    background: #0a0c10;
}

/* little pulse on the dot when pinned */
@keyframes pinPulse {
    0% {
        box-shadow: 0 0 0 0 color-mix(in oklab, var(--accent, #6ea8fe) 45%, transparent);
    }

    100% {
        box-shadow: 0 0 0 14px transparent;
    }
}

.scenario-toolbar .pin-btn.pulse .dot {
    animation: pinPulse 800ms ease-out;
}

.kicker {
    font-weight: 500;
    color: var(--text-3);
    margin-left: .25rem;
    font-size: .9em;
}

.hint {
    display: block;
    margin-top: .35rem;
    color: var(--text-3);
    font-size: .85rem;
}

.opx-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 10px;
}

.custom-exp-list .cx-row {
    padding: 12px;
    border-radius: 10px;
    background: var(--panel-2);
    margin-top: 10px;
}

.custom-exp-list .grid-4 {
    display: grid;
    grid-template-columns: 1.2fr 1fr 1fr 1fr;
    gap: 12px;
}

.cx-base-wrap {
    margin-top: 8px;
}

.row-actions {
    margin-top: 8px;
    display: flex;
    justify-content: flex-end;
}

.kicker {
    color: var(--text-3);
    font-size: .88em;
    margin-left: .25rem;
}

.hidden {
    display: none !important;
}

/* Make the whole custom expenses section span the full inputs grid
     only when the user selected Services = Custom */
#ner-form[data-service="custom"] #customSection {
    grid-column: 1 / -1;
    /* full width of the parent grid */
}

/* Card look for each custom expense row */
#customSection .custom-row {
    display: grid;
    grid-template-columns:
        minmax(180px, 2fr)
        /* label */
        140px
        /* $/SF/yr amount */
        120px
        /* growth input */
        120px
        /* growth unit (%/yr | $/SF/yr) */
        minmax(180px, 2fr)
        /* pass-through mode */
        auto;
    /* remove button */
    gap: 12px;
    align-items: center;
    background: var(--surface-2, rgba(255, 255, 255, 0.04));
    border: 1px solid var(--border-1, rgba(255, 255, 255, 0.08));
    border-radius: 12px;
    padding: 12px;
    margin-bottom: 12px;
}

/* Tidy margins inside the row */
#customSection .custom-row .field {
    margin: 0;
}

#customSection .custom-row .btn-remove {
    justify-self: end;
}

/* Inputs with addons should stretch nicely inside the row */
#customSection .custom-row .input-with-addon {
    width: 100%;
}

/* Responsive: stack to fewer columns on smaller screens */
@media (max-width: 1024px) {
    #customSection .custom-row {
        grid-template-columns:
            minmax(180px, 1fr) 140px 120px 120px minmax(180px, 1fr) auto;
    }
}

@media (max-width: 780px) {
    #customSection .custom-row {
        grid-template-columns: 1fr 1fr;
        grid-auto-rows: minmax(44px, auto);
    }

    #customSection .custom-row .btn-remove {
        grid-column: 2;
        justify-self: end;
    }
}

/* Let the advanced row span across the full calculator width */
.opx-adv.col-1-4 {
    grid-column: 1 / -1;
}

.adv-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
}

.adv-group {
    padding: 10px;
    background: var(--panel-2);
    border-radius: 10px;
}

.adv-title {
    font-weight: 600;
    margin-bottom: 6px;
}

.adv-inline {
    display: flex;
    gap: 8px;
    align-items: center;
    flex-wrap: wrap;
}

.w-16 {
    width: 5.5rem;
}

.w-20 {
    width: 6.5rem;
}

.w-28 {
    width: 8.5rem;
}

.mt-2 {
    margin-top: 8px;
}

/* subtle inline chips under the NER card in Landlord view */
.cards .kpi-meta .chip {
    background: var(--surface-3, rgba(255, 255, 255, .06));
    border: 1px solid var(--surface-4, rgba(255, 255, 255, .10));
    border-radius: 10px;
    padding: 2px 8px;
    font-size: 12px;
    line-height: 18px;
}

/* schedule tables */
.panel-results table th:first-child,
.panel-results table td:first-child {
    width: 88px;
    text-align: center;
    white-space: nowrap;
}

.panel-results table td.num {
    text-align: right;
}

/* Scenario compare – emphasized rows */
.cf-mini tr.em-row th,
.cf-mini tr.em-row td {
    font-weight: 700;
    background: rgba(255, 255, 255, 0.06);
    /* subtle highlight for dark theme */
}

.commnpv-flex {
    display: flex;
    gap: 16px;
    align-items: flex-end;
    flex-wrap: wrap;
    /* allows wrap on small widths */
}

/* 3/12, 2/12, 7/12 split */
#brokerCommField {
    flex: 0 0 25%;
    min-width: 220px;
}

#brokerCommBasisField {
    flex: 0 0 16%;
    min-width: 140px;
}

#discountField {
    flex: 1 0 0;
    min-width: 260px;
}

@media (max-width: 960px) {

    #brokerCommField,
    #brokerCommBasisField,
    #discountField {
        flex: 1 0 100%;
    }
}

/* Commissions & NPV only */
.commnpv-flex {
    display: flex;
    gap: 16px;
    align-items: flex-end;
    flex-wrap: wrap;
    /* wrap on smaller widths */
}

/* Desktop proportions: 3/12, 2/12, 7/12 */
#brokerCommField {
    flex: 0 0 25%;
    min-width: 220px;
}

#brokerCommBasisField {
    flex: 0 0 16%;
    min-width: 140px;
}

#discountField {
    flex: 1 0 0;
    min-width: 260px;
}

@media (max-width: 960px) {
    .commnpv-flex>.field {
        flex: 1 0 100%;
    }

    /* full width stacked */
}

/* Commissions & NPV only */
.commnpv-flex {
    display: flex;
    gap: 16px;
    align-items: flex-end;
    flex-wrap: wrap;
    /* wrap on smaller widths */
}

/* Desktop proportions: 3/12, 2/12, 7/12 */
#brokerCommField {
    flex: 0 0 25%;
    min-width: 220px;
}

#brokerCommBasisField {
    flex: 0 0 16%;
    min-width: 140px;
}

#discountField {
    flex: 1 0 0;
    min-width: 260px;
}

@media (max-width: 960px) {
    .commnpv-flex>.field {
        flex: 1 0 100%;
    }

    /* full width stacked */
}

/* --- Commissions & NPV: horizontal layout, scoped --- */
#commnpvBody .commnpv-flex {
    display: grid;
    grid-template-columns: minmax(220px, 3fr) minmax(140px, 2fr) minmax(260px, 7fr);
    column-gap: 16px;
    row-gap: 16px;
    align-items: end;
    /* bottoms line up */
}

/* Kill any global 100%-width utilities inside this row */
#commnpvBody .commnpv-flex>.field {
    width: auto !important;
    max-width: none !important;
}

@media (max-width: 960px) {
    #commnpvBody .commnpv-flex {
        grid-template-columns: 1fr;
        /* stack on small screens */
    }
}

/* put with your other small utilities */
.commnpv-flex {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.commnpv-flex .field {
    flex: 1 1 240px;
    min-width: 240px;
}

/* Section headers */
.section-head {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: 12px;
    padding-top: 20px;
    margin: 24px 0 8px;
    border-top: 1px solid var(--border-weak, rgba(255, 255, 255, 0.08));
}

.section-title {
    font-size: 1.05rem;
    font-weight: 700;
    letter-spacing: .2px;
    margin: 0;
}

.section-sub {
    margin: 0;
    font-size: .9rem;
    color: var(--muted, #9aa0a6);
}

/* Optional: give big “groups” a soft card look */
.group {
    grid-column: 1 / -1;
    /* full width in your grid-4 */
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--border-weak, rgba(255, 255, 255, 0.08));
    border-radius: 12px;
    padding: 14px;
}

.group+.group {
    margin-top: 16px;
}

/* Spacing helpers (use on any wrapper) */
.stack>*+* {
    margin-top: 10px;
}

.pad-y {
    padding-block: 12px;
}

/* ─────────────────────────────────────────────────────────────
     CapEx / Buildout editor — single-source-of-truth CSS
     Columns: Item | Entry | Amount | $/SF | Total | [Del]
     Adjust widths in --capex-cols if needed.
     ───────────────────────────────────────────────────────────── */

:root {
    /* Item | Entry | Amount | $/SF | Total | Delete */
    --capex-cols: 1.4fr 0.9fr minmax(140px, 1fr) minmax(110px, .7fr) minmax(160px, .9fr) 40px;
}

.capex-editor {
    margin-top: 8px;
    display: grid;
    gap: 10px;
}

/* Header + rows: same grid so columns line up perfectly */
.capex-head,
.capex-row {
    display: grid;
    grid-template-columns: var(--capex-cols);
    gap: 8px;
    align-items: center;
}

.capex-head {
    font-size: 12px;
    opacity: .7;
}

/* Right-align numeric headers ($/SF & Total) */
.capex-head>span:nth-child(4),
.capex-head>span:nth-child(5) {
    text-align: right;
    justify-self: end;
}

/* Inputs fill their cell */
.capex-row input[type="text"],
.capex-row input[inputmode="decimal"] {
    width: 100%;
}

/* Per-row $/SF + Total (right aligned, tabular nums) */
.capex-row .capex-psf,
.capex-row .capex-row-total {
    text-align: right;
    justify-self: end;
    font-variant-numeric: tabular-nums;
    padding-right: 6px;
    /* keeps numbers off the delete button edge */
}

/* Delete button lives in its own final column */
.capex-row .capex-del {
    width: 32px;
    height: 32px;
    display: grid;
    place-items: center;
    border-radius: 9999px;
    background: var(--panel-3, #2b2b2b);
    border: 1px solid var(--stroke, #3a3a3a);
    cursor: pointer;
    line-height: 1;
}

/* Totals footer uses the same grid so $/SF + Total line up under cols 4 & 5 */
.capex-totals {
    display: grid;
    grid-template-columns: var(--capex-cols);
    gap: 8px;
    margin-top: 6px;
}

.capex-totals .row {
    display: contents;
}

/* Label spans first three columns (Item+Entry+Amount) */
.capex-totals .label {
    grid-column: 1 / span 3;
}

/* $/SF column (bold like Total) */
.capex-totals .psf {
    grid-column: 4;
    text-align: right;
    justify-self: end;
    font-variant-numeric: tabular-nums;
    font-weight: 600;
}

/* Total column */
.capex-totals .total {
    grid-column: 5;
    text-align: right;
    justify-self: end;
    font-variant-numeric: tabular-nums;
    font-weight: 600;
}

/* Draw a single ‘rule’ before the Net line (spans across all content columns) */
.capex-totals .row:last-child .label,
.capex-totals .row:last-child .psf,
.capex-totals .row:last-child .total {
    border-top: 1px solid var(--stroke);
    padding-top: 6px;
    margin-top: 4px;
}

/* State colors for Net Tenant ($ and $/SF) */
.capex-totals .is-ok {
    color: var(--ok, #22c55e);
}

.capex-totals .is-over {
    color: var(--danger, #ef4444);
}

/* Summary (details/summary) */
#capexDetails summary::-webkit-details-marker {
    display: none;
}

#capexDetails summary::marker {
    content: "";
}

.capex-summary {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    border-radius: 10px;
    background: var(--panel-2, #222);
    cursor: pointer;
    user-select: none;
}

#capexDetails .chev {
    transition: transform .18s ease;
}

#capexDetails[open] .chev {
    transform: rotate(90deg);
}

.capex-summary .chip {
    margin-left: auto;
    padding: 2px 8px;
    border-radius: 9999px;
    background: var(--panel-3, #2b2b2b);
    font-size: 12px;
    opacity: .85;
}

/* Your capex-totals already uses the same 6-column grid via var(--capex-cols) */
.capex-totals {
    display: grid;
    grid-template-columns: var(--capex-cols);
    gap: 8px;
}

.capex-totals .row {
    display: contents;
}

/* The single horizontal rule */
.capex-hr {
    grid-column: 1 / -1;
    /* span all columns */
    height: 0;
    border-top: 1px solid var(--stroke);
    margin-top: 4px;
}

/* Kill the old per-cell border on the last totals row */
.capex-totals>div:last-child,
.capex-totals .row:last-child .label,
.capex-totals .row:last-child .psf,
.capex-totals .row:last-child .total,
.capex-totals [data-row="net"] {
    border-top: none !important;
    margin-top: 0 !important;
    padding-top: 0 !important;
}

/* Keep spacing below the single full-width rule */
#capexNetRow .label,
#capexNetRow .psf,
#capexNetRow .total {
    padding-top: 6px;
}

/* Give the Net row a little breathing room below the rule */
#capexNetRow .label,
#capexNetRow .psf,
#capexNetRow .total {
    padding-top: 6px;
}

/* Grand total row (Annual/Monthly schedules) */
.grand-total {
    border-top: 1px solid var(--stroke);
    font-weight: 600;
}

.grand-total .muted {
    opacity: .7;
    /* for the em-dash cells */
    font-weight: 400;
}

.grand-total td {
    padding-top: 8px;
}

/* KPI chip */
.kpi {
    position: relative;
}

.term-chip {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 8px;
}

.term-chip .chip {
    font-size: 12px;
    line-height: 1.2;
    padding: 2px 8px;
}

th .hdr-note {
    display: block;
    font-size: 11px;
    font-weight: 500;
    opacity: .7;
    margin-top: 2px;
}

/* Popup container + content */
.maplibregl-popup,
.mapboxgl-popup {
    font-family: inherit;
}

.maplibregl-popup-content,
.mapboxgl-popup-content {
    background: #000;
    /* black card */
    color: #fff;
    /* white text */
    border-radius: 10px;
    padding: 10px 12px;
    box-shadow: 0 6px 24px rgba(0, 0, 0, .35);
}

/* Title + body inside your custom markup */
.map-card-title {
    color: #fff;
    font-weight: 700;
    margin-bottom: 4px;
}

.map-card-body {
    color: #fff;
    opacity: .95;
}

/* Make the popup arrow (tip) black for all anchor positions */
.maplibregl-popup-anchor-top .maplibregl-popup-tip,
.mapboxgl-popup-anchor-top .mapboxgl-popup-tip {
    border-bottom-color: #000;
}

.maplibregl-popup-anchor-bottom .maplibregl-popup-tip,
.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip {
    border-top-color: #000;
}

.maplibregl-popup-anchor-left .maplibregl-popup-tip,
.mapboxgl-popup-anchor-left .mapboxgl-popup-tip {
    border-right-color: #000;
}

.maplibregl-popup-anchor-right .maplibregl-popup-tip,
.mapboxgl-popup-anchor-right .mapboxgl-popup-tip {
    border-left-color: #000;
}

/* Optional: links inside the card */
.maplibregl-popup-content a,
.mapboxgl-popup-content a {
    color: #9bd3ff;
    text-decoration: underline; }


/* allow the marker element to receive the drag */
.lee-pin {
    /* must be able to receive pointer events for dragging */
    pointer-events: auto;
    /* NOT none */
    touch-action: none;
    /* avoid browser touch panning stealing the drag */
    cursor: grab;
    width: 50px;
    height: 42px;
    display: block;
    filter: drop-shadow(0 8px 18px rgba(0, 0, 0, .35));
}

.show-hidden-toggle {
  display: inline-flex;
  gap: .5rem;
  align-items: center;
  margin-left: .75rem;
  opacity: .85;
}

.pill {
  font-size: .7rem;
  padding: .15rem .4rem;
  border-radius: 999px;
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(255,255,255,.12);
}

.pill-muted {
  opacity: .9;
}

td[data-unit] {
  position: relative;
}

td[data-unit][title] {
  cursor: help;
}

/* Toggle container buttons */
.toggle-btn {
  padding: 0.5rem 0.9rem;
  border-radius: 0.5rem;
  border: 1px solid var(--border, #2a2a2a);
  background: var(--surface, #111);
  color: var(--text, #eaeaea);
  font-weight: 600;
}

.toggle-btn.active {
  background: var(--accent, #b30000);
  border-color: var(--accent, #b30000);
  color: #fff;
}

/* Panels share common class; 'hidden' controls visibility */
.toggle-panel.hidden { display: none !important; }

.compare-toggle {
  display:flex;
  align-items:center;
  gap:.5rem;
  margin:16px 0 8px;
}
.chip.chip-tab {
  padding:6px 10px;
  border-radius:12px;
  border:1px solid var(--border, #2b2f36);
  background:#15181d;
  color:#dfe6ef;
  font-weight:600;
  cursor:pointer;
}
.chip.chip-active {
  border-color: var(--accent, #e71d36);
  box-shadow: 0 0 0 1px rgba(231,29,54,.35) inset;
}
.compare-toggle .spacer {
  flex:1 1 auto;
}
.compare-panel {
  width:100%;
}
.compare-controls {
  display:flex;
  align-items:center;
  gap:12px;
}
.compare-controls .compareCount {
  order:2;
}
.compare-header #hiddenRowsToggleWrap {
  margin-left:auto;
}
.summary-grid {
  display:block;
  overflow:auto;
  border-radius:12px;
  background:#0e1116;
  border:1px solid #1f232a;
}
.summary-grid table {
  border-collapse:separate;
  border-spacing:0;
  width:max-content;
  min-width:100%;
}
.summary-grid th,
.summary-grid td {
  padding:10px 12px;
  border-bottom:1px solid #1a1e25;
  white-space:nowrap;
  vertical-align:middle;
}
.summary-grid thead th {
  position:sticky;
  top:0;
  background:#0e1116;
  z-index:4;
  box-shadow: 0 1px 0 #1a1e25;
}
.summary-grid .metric-col {
  position:sticky;
  left:0;
  background:#0e1116;
  z-index:3;
  min-width:260px;
  font-weight:700;
}
.summary-grid tbody td.metric-col {
  position:sticky;
  left:0;
  background:#0e1116;
}
.summary-grid .group-row {
  background:transparent;
}
.summary-grid .col-card {
  min-width:260px;
}
.summary-grid th.summary-col,
.summary-grid td.summary-col {
  padding:0;
}
.summary-grid .summary-col {
  --summary-col-bg: rgba(255,255,255,0.03);
  --summary-col-border: rgba(255,255,255,0.05);
  position:relative;
}
.summary-grid .summary-col .summary-col-inner {
  position:relative;
  z-index:0;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
  gap:6px;
  padding:10px 12px;
  border-radius:14px;
  background:var(--summary-col-bg);
  border:1px solid var(--summary-col-border);
  box-shadow:inset 0 1px 0 rgba(255,255,255,0.04);
  transition:border-color .25s ease, box-shadow .25s ease, background-color .25s ease;
}
.summary-grid tbody .summary-col .summary-col-inner {
  min-height:44px;
  justify-content:center;
}
.summary-grid .summary-col .summary-col-inner::after {
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  background:transparent;
  opacity:0;
  pointer-events:none;
  transition:opacity .25s ease;
}
.summary-grid .summary-col.best .summary-col-inner::after {
  background:radial-gradient(600px 80px at 0% 50%, rgba(231,29,54,.12), transparent);
  opacity:1;
}
.summary-grid .summary-col.dim .summary-col-inner {
  color:#6b7686;
}
.summary-grid .summary-col[data-rank="1"] .summary-col-inner {
  border-color:rgba(100,210,255,0.5);
  box-shadow:0 0 22px rgba(100,210,255,0.24), inset 0 0 0 1px rgba(100,210,255,0.35);
}
.summary-grid thead .summary-col[data-rank="1"] .summary-col-inner {
  box-shadow:0 0 26px rgba(100,210,255,0.26), inset 0 0 0 1px rgba(100,210,255,0.45);
}
.summary-grid [data-col="0"],
.summary-grid [data-col="5"],
.summary-grid [data-col="10"] {
  --summary-col-bg: rgba(100,210,255,0.08);
  --summary-col-border: rgba(100,210,255,0.24);
}
.summary-grid [data-col="1"],
.summary-grid [data-col="6"],
.summary-grid [data-col="11"] {
  --summary-col-bg: rgba(166,105,255,0.10);
  --summary-col-border: rgba(166,105,255,0.28);
}
.summary-grid [data-col="2"],
.summary-grid [data-col="7"],
.summary-grid [data-col="12"] {
  --summary-col-bg: rgba(46,213,115,0.10);
  --summary-col-border: rgba(46,213,115,0.26);
}
.summary-grid [data-col="3"],
.summary-grid [data-col="8"],
.summary-grid [data-col="13"] {
  --summary-col-bg: rgba(255,159,67,0.08);
  --summary-col-border: rgba(255,159,67,0.24);
}
.summary-grid [data-col="4"],
.summary-grid [data-col="9"],
.summary-grid [data-col="14"] {
  --summary-col-bg: rgba(255,107,129,0.10);
  --summary-col-border: rgba(255,107,129,0.28);
}
.summary-grid .chip {
  display:inline-block;
  padding:2px 8px;
  border-radius:999px;
  font-size:12px;
  background:#1a1e25;
  color:#cbd5e1;
  border:1px solid #232832;
}
.summary-grid .chip.red {
  border-color:#e71d36;
  color:#ffdfe4;
}
.summary-grid .photo {
  width:100%;
  height:120px;
  object-fit:cover;
  border-radius:10px;
  border:1px solid #1f232a;
}
.summary-grid .sortable {
  cursor:pointer;
}
.summary-grid .sortable:hover {
  color:#fff;
}
.summary-grid .note {
  opacity:.75;
  font-size:12px;
}

.comparison-summary .summary-grid .group-row td {
  padding:0;
  border-bottom:none;
  background:transparent;
}

.comparison-summary .summary-grid tbody td.metric-col::before {
  content:none !important;
}

/*
 * Note: the previous vertical accent was applied via a border-left on
 * .summary-grid .best and the sticky label pseudo-element.
 * Column containers now handle the glow/overlay via .summary-col-inner::after.
 * The header styling below mirrors the Rent Schedule grand total row
 * (css/styles.css -> .row-grandtotal) for color and borders.
 */
.comparison-summary .section-header-bar {
  display:flex;
  align-items:center;
  justify-content:center;
  padding:10px 12px;
  margin:12px 0 8px;
  border-radius:6px;
  border-top:2px solid var(--accent, #0a84ff);
  border-bottom:2px solid var(--accent, #0a84ff);
  background:color-mix(in srgb, var(--accent, #0a84ff) 16%, transparent);
  color:#ffffff;
  font-weight:700;
  text-align:center;
}

.comparison-summary .section-header-bar:first-child {
  margin-top:0;
}

.comparison-summary .section-header-label {
  display:inline-block;
  letter-spacing:.2px;
}

.comparison-summary .summary-grid .group-row:first-of-type .section-header-bar {
  margin-top:0;
}
